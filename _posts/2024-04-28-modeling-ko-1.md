---
layout: post
title:  "자린고비 모델링1: 논리 모델링"
author: jane
categories: [ Data-Modeling ]
tags: [프로젝트-자린고비]
---

### 0. Preview
'자린고비'는 한 가지 음식을 만들기 위해 필요한 재료의 총 가격을 다양한 유튜브 영상 레시피별로 비교하여 가장 저렴한 옵션으로 요리할 수 있는 방법을 알려주는 서비스입니다. 서비스를 구현하기 전에, 유튜브로부터 레시피 정보를, 그리고 쿠팡으로부터 식재료의 단위 가격을 포함한 주요 상품 정보를 수집해 필요한 데이터를 미리 구축해야 합니다. 이 과정에서 데이터 처리를 담당하는 ETL 레이어와 실제 서비스 운영을 담당하는 서비스 레이어 사이에는 몇 가지 차이점이 있습니다. ETL 레이어를 'Raw Data', 서비스 레이어를 'Service'라고 명명한 후, 두 레이어 간의 차이를 비교하면 아래와 같습니다.<br>

- Raw Data
  - 초기 형태가 반정형 데이터 (html)
  - html로부터 원하는 값을 스크래핑 후 전처리하는 로직이 길고 까다로움
  - 크롤링 시간 간격 제한 있음 (robots.txt 정책)
- Service
  - 쿼리를 통한 색인 대상
  - 사용자에게 보여지는 데이터
<br>

이러한 이유로, 두 레이어의 스키마는 'raw_data'와 'service'로 구분하여 설계되었습니다. 'raw_data' 스키마는 저장 속도와 개발자의 편의를 중시하여 테이블 수를 적게 하고 정규화를 최소화한 반면, 'service' 스키마는 데이터의 무결성, 정합성, 확장성을 중요시하여 정규화 원칙을 준수하고 키 제약 조건을 세밀하게 설계하였습니다.<br>

본 프로젝트에서는 기본 엔티티만 도출했습니다. 첫 모델링에서는 MVP의 정의와 기능 구현의 한계를 가장 많이 고려했습니다. 유튜브 검색 대상이 되는 음식명들은 공개된 음식명 데이터셋을 확보해 DB에 저장 후 활용했습니다. 재료명은 유튜브 레시피 정보로부터 도출되기에, 결과적으로 유튜브영상→레시피→재료(재료명, 단위, 용량)→쿠팡상품정보 라는 종속성을 갖습니다.<br><br><br>



### 1. 엔티티 & 속성 정의
아래는 엔티티와 속성을 도출하는 데 있어 이슈가 되는 부분들입니다.<br><br>


#### 1) 유튜브 데이터 ETL
##### 유튜브 영상과 요리명(=음식명=메뉴명) 간 관계
유튜브 크롤링 과정에서 한 음식의 검색 결과로 나오는 영상을 10개 수집합니다. 이 때 검색한 메뉴명과 일치하는 요리를 하는 레시피만 나오지 않는 경우가 존재합니다. 이를테면 김치찌개를 검색했지만 부대찌개 레시피 영상이 함께 나오는 겁니다. 하지만 데이터 저장 과정의 MVP 정의에는 이에 대한 검증 처리 로직이 없습니다 (개발해야겠다..). 따라서 하나의 영상은 N개의 요리명과 관계를 갖습니다. 상식적으로는 1:1의 관계를 가지며, 별도의 이유가 없는 한 메뉴명 테이블이 꼭 분리돼있지 않아도 됩니다.
<br><br>

##### 유튜브 정보 text 전처리의 높은 난도
*텍스트 데이터의 불완전성, null 얘기는 여기 아니고 다음 편에서 다룰지도?
레시피 유튜브 영상 하단을 보면 시청자의 편의를 위해 영상 속 레시피 내용을 기재해 놓은 경우가 많습니다. 이를 십분 활용해, 본 프로젝트의 MVP에서는 상용 LLM 서비스의 일종인 google gemini의 도움을 받아 해당 text로부터 레시피 정보를 추출합니다. 이 과정에서 수반되는 문제가 2가지 있습니다. 하나는 레시피가 텍스트로 별도 기재돼 있지 않은 경우입니다. 다른 하나는 gemini가 레시피 정보를 제대로 추출해내지 못한 경우입니다.
<br><br>



#### 2) 쿠팡 데이터 ETL
##### 한 식재료의 상품 저장 개수
<br><br>

##### 최저가 도출 시점
<br><br>



#### 3) 기타
##### (1) 메뉴명과 재료명 간 중복


위와 같은 사항을 고려해 엔티티를 추출한 결과는 아래와 같습니다.<br><br>

#### raw_data

|Entity|Attribute|
|---|---|
|레시피|출처가 된 유튜브 영상|
|메뉴|메뉴명|
|재료|재료명|
